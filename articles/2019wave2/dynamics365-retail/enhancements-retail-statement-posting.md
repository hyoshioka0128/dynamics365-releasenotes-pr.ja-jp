---
title: 小売明細転記の機能強化
description: 小売明細転記の機能強化
author: relnotes
ms.reviewer: josaw
ms.date: 07/22/2019
ms.assetid: 1102a192-f76c-e911-a98c-000d3a4f3343
ms.topic: article
ms.service: business-applications
ms.author: rapraj
dynamics365pdf: true
ms.openlocfilehash: 45c05865bf927c0640f800dacdc3b3220c6085fb
ms.sourcegitcommit: 4101748c25acf79b22e31a01b73969500926ff91
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/30/2019
ms.locfileid: "1794324"
---
# <a name="enhancements-to-retail-statement-posting"></a>小売明細転記の機能強化
[!include[dynamics365-retail banner](../includes/dynamics365-retail.md)]

| 有効対象    |  パブリック プレビュー | 一般提供 | 
| ---------- | ---------- |---------- |
|エンド ユーザー、管理者/作成者による有効化、またはアナリスト|2019 年 8 月| 2019 年 10 月|


## <a name="business-value"></a>ビジネス バリュー
<!-- bv start -->
Microsoft Dynamics 365 for Retail では、クラウド販売時点管理 (POS) または Modern POS (MPOS) で発生するトランザクションの明細を示すために明細書転記プロセスが使用されます。 店舗での 1 営業日の販売、支払、現金移動などに関するすべてのトランザクションがこのプロセスを通じて本社 (HQ) に反映されるため、このプロセスは実店舗の業務に不可欠な機能です。 HQ の担当者が意思決定に使用するすべての重要な日次レポート (1 日の店舗別売上、1 日の店舗別回収、さまざまな商品/カテゴリの在庫移動など) は、明細書転記プロセスを通じて提供されます。 

明細書転記プロセスは、小売組織の損失防止機能においても中心的役割を果たします。販売監査担当者が、詐欺と損失の防止に関する問題やパターンを監視および追跡するために明細書転記プロセスからのデータを使用するからです。 そのため、実店舗を持つすべての小売組織には、信頼性とパフォーマンスの高い明細書転記プロセスが不可欠です。
<!-- bv end -->



## <a name="feature-details"></a>機能の詳細
<!--feature detail start -->
この機能は、現在の明細書転記プロセスをここで説明する方法で強化します。

### <a name="data-fidelity-checker"></a>データ信頼性チェッカー

明細書転記プロセスの信頼性は、このプロセスに供給されるデータの品質に大きく依存します。 このデータはファースト パーティまたはサード パーティの POS システムでのトランザクションに基づいて生成され、小売店舗から送信されます。 整合性のないデータを店舗データベースに書き込む POS クライアントのバグや、統合フレームワークを通じてサード パーティの POS システムから取り込まれたデータなどの要因により、店舗から届くデータの信頼性が疑わしいことはよくあります。 これにより、明細書転記の下流プロセスで問題やバグが発生します。 これらの課題を克服するため、データ信頼性チェッカーはデータに脱落や異常がないかどうかをチェックし、検証に合格したトランザクションのみが明細書転記プロセスに含まれるようにします。 以下に、データ信頼性チェッカーで実行される検証の種類の一部を示します (これは完全な一覧ではありません)。

- ギフト カード品目が返品明細行に関連付けられていないことを検証します。 

- トランザクションごとに、割引テーブルのレコードが小売トランザクション明細行テーブルの割引金額と一致することを検証します。 

- 小売トランザクション支払明細行の金額を合計すると、ヘッダーの小売トランザクション テーブルの支払金額になることを検証します。

- トランザクションごとに、税テーブルのレコードが小売トランザクション明細行テーブルの税額と一致することを検証します。

データ信頼性チェッカー機能では、ユーザーがトレーサビリティと調整の目的で監査に設定した期待に反するトランザクションを修正することもできます。

### <a name="trickle-feed-order-creation"></a>トリクル フィード命令の作成

現在の明細書転記プロセスは、主に 2 つの部分で管理されます。

- HQ に同期されたデータに基づいて、"在庫ジョブ" が、定義された定期的なスケジュールで製品の在庫を引き当てます。

- 1 日の終わりに、閉店して店舗で営業終了操作が実行されると、残りのデータが HQ に同期されます。 定義されたスケジュールに基づいて、システムは各店舗の明細書ドキュメントを作成します。この明細書ドキュメントが転記されると、システムは作成された在庫の引当を削除し、販売注文、支払仕訳帳、仕訳元帳をシステム内に作成します。

上記の点から明らかなように、日中は一時的な在庫引当のみが作成されます。 これらの在庫引当は 1 日の終わりに削除され、すべてのトランザクションが販売注文として処理され、新しい在庫トランザクションが 1 日の終わりに他のトランザクションと共に作成されます。 日中はこれらのトランザクションの処理は行われず、すべてのトランザクションの処理が 1 日の終わりまで持ち越されます。 そのため、大規模なトランザクションを限られた時間枠内で処理しなければならなくなり、大量の負荷とロックが発生して明細書の転記が失敗することがあります。

このような問題に対処するために、明細書転記プロセスが次のように改善されます。

- 一時的な引当を作成する "在庫ジョブ" を廃止します。

- 事前に定義されたスケジュールで販売注文を作成し、請求書を発行し、その時点で HQ と同期されるすべてのトランザクションの支払を作成、転記、適用する、新しいジョブを作成します。 さらに、このジョブは割引やギフト カードなどのために作成する必要がある元帳仕訳帳も作成します。

- 1 日の終わりに作成される明細書ドキュメントは、数量の差異を計算および転記する目的でのみ使用されるようになります。

### <a name="handling-of-return-lines"></a>返品明細行の処理

返品明細行が正しい返品原価で転記されるようにするために、現在の小売明細書転記プロセスでは、返品を転記する前に元の販売が転記されている必要があります。 しかし、元の販売が転記されていないシナリオでは、返品トランザクションに関連する明細書も転記できません。 その結果、明細書がバックアップされ、ユーザーは明細書を正しい順序で手動で転記する前に依存関係を見つけなければならなくなります。 これを解決し、明細書間に時間的な依存関係が適用されることを避けるために、今後は返品が元の販売の営業日からの在庫原価を利用して転記されるようになります。

### <a name="handling-of-batch-controlled-items"></a>バッチ管理される品目の処理

バッチ管理される品目に対しては、Retail POS で販売時点のバッチ番号の取得がサポートされません。 しかし、これらの製品の販売を HQ で転記する際にはバッチ番号が必要です。 現在の明細書転記フレームワークでは、明細の転記時点で既存のバッチ番号を取得します。 しかし、これらの製品に対してバッチ番号を持つ数量が存在しないシナリオでは、製品でマイナス在庫が有効になっている場合でも明細書転記プロセスが失敗します。 この機能により、バッチ管理される品目でマイナス在庫が有効になっている場合は、品目の在庫がゼロであるかバッチ番号を利用できないときでも明細書の転記がブロックされなくなります。
<!--feature detail end -->











